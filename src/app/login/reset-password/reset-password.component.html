<div class="wrapper">
    <app-side-panel></app-side-panel>
    <div class="frm-wrapper">
      <section class="frm-block">
        <div class="container">
          <app-login-logo></app-login-logo>
          <div class="row">
            <div class="col-sm-12">
              <div class="frm-outer">
                <div class="frm-body">
                  <h4>Forgot Password</h4>
                  <div class="reset-2fa">If you have lost your 2FA token, please <a href="mailto:support@idap.io">email us</a> with the subject “Lost 2FA Device”.<br><br>IDAP Exchange support will then email you an ID verification link.</div>
                  <form [formGroup]="resetPasswordGroup" (ngSubmit)="resetPassword();">
                    <div *ngIf="error" class="auth-error">
                      <p>
                          {{error}}
                      </p>
                      
                    </div>
                    <div *ngIf="!resetPasswordSuccessMsg">
                      <div class="form-group input-ico pwd">
                        <label for="password" class="form-label">New Password</label>
                        <input 
                        class="form-input"
                        formControlName="newPassword"
                        type="password"
                        [ngClass]="{'is-invalid': submitted && formFields.newPassword.errors}"
                        maxlength="20"
                        minlength="8"
                        placeholder="8-20 alpha numeric characters" 
                        pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                        >
                      <div *ngIf="submitted && formFields.newPassword.errors" class="form-valid-error">
                            <div *ngIf="formFields.newPassword.errors.required">Password is required!</div>
                            <div *ngIf="formFields.newPassword.errors.minlength">Password should be minimum of {{formFields.newPassword.errors.minlength.requiredLength}} characters!</div>
                            <div *ngIf="formFields.newPassword.errors.pattern && !formFields.newPassword.errors.minlength" class="error-msg">
                                Your password must contain at least one lowercase letter, one capital letter and one number
                            </div>
                      </div>
                      </div>
                      <div class="form-group input-ico pwd">
                        <label for="password" class="form-label">Confirm Password</label>
                        <input
                        class="form-input"
                        formControlName="confirmPassword"
                        type="password"
                        [ngClass]="{'is-invalid': submitted && formFields.confirmPassword.errors}"
                        maxlength="20"
                        >
                        <div *ngIf="submitted && formFields.confirmPassword.errors" class="form-valid-error">
                          <div *ngIf="formFields.confirmPassword.errors.required">Confirm password is required!</div>
                          <div *ngIf="formFields.confirmPassword.errors.mustMatch">Passwords must match!</div>
                        </div>
                      </div>
                      <div class="text-center">
                        <button class="form-button" type="submit">Change my password</button>
                      </div>
                  </div>
                    <div class="resetPassSuccess" *ngIf="resetPasswordSuccessMsg">{{ resetPasswordSuccessMsg }}</div>

                    <div class="frm-footer">
                        <div class="forgot">Back to <a routerLink="/login">Log In</a></div>
                      </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  <app-login-footer></app-login-footer>